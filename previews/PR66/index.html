<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Home ¬∑ TrixiAtmo.jl</title><meta name="title" content="Home ¬∑ TrixiAtmo.jl"/><meta property="og:title" content="Home ¬∑ TrixiAtmo.jl"/><meta property="twitter:title" content="Home ¬∑ TrixiAtmo.jl"/><meta name="description" content="Documentation for TrixiAtmo.jl."/><meta property="og:description" content="Documentation for TrixiAtmo.jl."/><meta property="twitter:description" content="Documentation for TrixiAtmo.jl."/><meta property="og:url" content="https://trixi-framework.github.io/TrixiAtmo.jl/"/><meta property="twitter:url" content="https://trixi-framework.github.io/TrixiAtmo.jl/"/><link rel="canonical" href="https://trixi-framework.github.io/TrixiAtmo.jl/"/><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="search_index.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href>TrixiAtmo.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>Home</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Home</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Home</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/trixi-framework/TrixiAtmo.jl/blob/{commit}{path}#{line}" title="View the repository on GitHub"><span class="docs-icon fa-brands">ÔÇõ</span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/trixi-framework/TrixiAtmo.jl/blob/{commit}{path}#{line}/blob/main/docs/src/index.md" title="Edit source on GitHub"><span class="docs-icon fa-solid">ÔÅÑ</span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="TrixiAtmo"><a class="docs-heading-anchor" href="#TrixiAtmo">TrixiAtmo</a><a id="TrixiAtmo-1"></a><a class="docs-heading-anchor-permalink" href="#TrixiAtmo" title="Permalink"></a></h1><p>Documentation for <a href="https://github.com/trixi-framework/TrixiAtmo.jl">TrixiAtmo</a>.</p><ul><li><a href="#TrixiAtmo.TrixiAtmo"><code>TrixiAtmo.TrixiAtmo</code></a></li><li><a href="#TrixiAtmo.AbstractCovariantEquations"><code>TrixiAtmo.AbstractCovariantEquations</code></a></li><li><a href="#TrixiAtmo.CovariantLinearAdvectionEquation2D"><code>TrixiAtmo.CovariantLinearAdvectionEquation2D</code></a></li><li><a href="#TrixiAtmo.CovariantShallowWaterEquations2D"><code>TrixiAtmo.CovariantShallowWaterEquations2D</code></a></li><li><a href="#TrixiAtmo.GlobalCartesianCoordinates"><code>TrixiAtmo.GlobalCartesianCoordinates</code></a></li><li><a href="#TrixiAtmo.GlobalSphericalCoordinates"><code>TrixiAtmo.GlobalSphericalCoordinates</code></a></li><li><a href="#TrixiAtmo.MetricTermsCrossProduct"><code>TrixiAtmo.MetricTermsCrossProduct</code></a></li><li><a href="#TrixiAtmo.MetricTermsInvariantCurl"><code>TrixiAtmo.MetricTermsInvariantCurl</code></a></li><li><a href="#TrixiAtmo.ShallowWaterEquations3D"><code>TrixiAtmo.ShallowWaterEquations3D</code></a></li><li><a href="#TrixiAtmo.SplitCovariantShallowWaterEquations2D"><code>TrixiAtmo.SplitCovariantShallowWaterEquations2D</code></a></li><li><a href="#Trixi.flux_fjordholm_etal-Tuple{Any, Any, AbstractVector, ShallowWaterEquations3D}"><code>Trixi.flux_fjordholm_etal</code></a></li><li><a href="#Trixi.flux_wintermeyer_etal-Tuple{Any, Any, AbstractVector, ShallowWaterEquations3D}"><code>Trixi.flux_wintermeyer_etal</code></a></li><li><a href="#TrixiAtmo.P4estMeshCubedSphere2D-Tuple{Any, Any}"><code>TrixiAtmo.P4estMeshCubedSphere2D</code></a></li><li><a href="#TrixiAtmo.P4estMeshQuadIcosahedron2D-Tuple{Any, Any}"><code>TrixiAtmo.P4estMeshQuadIcosahedron2D</code></a></li><li><a href="#TrixiAtmo.clean_solution_lagrange_multiplier!-Tuple{Any, ShallowWaterEquations3D, Any}"><code>TrixiAtmo.clean_solution_lagrange_multiplier!</code></a></li><li><a href="#TrixiAtmo.contravariant2global"><code>TrixiAtmo.contravariant2global</code></a></li><li><a href="#TrixiAtmo.examples_dir-Tuple{}"><code>TrixiAtmo.examples_dir</code></a></li><li><a href="#TrixiAtmo.global2contravariant"><code>TrixiAtmo.global2contravariant</code></a></li><li><a href="#TrixiAtmo.have_aux_node_vars-Tuple{Trixi.AbstractEquations}"><code>TrixiAtmo.have_aux_node_vars</code></a></li><li><a href="#TrixiAtmo.initial_condition_gaussian-Tuple{Any, Any, Any}"><code>TrixiAtmo.initial_condition_gaussian</code></a></li><li><a href="#TrixiAtmo.initial_condition_geostrophic_balance-Tuple{Any, Any, Any}"><code>TrixiAtmo.initial_condition_geostrophic_balance</code></a></li><li><a href="#TrixiAtmo.initial_condition_rossby_haurwitz-Tuple{Any, Any, Any}"><code>TrixiAtmo.initial_condition_rossby_haurwitz</code></a></li><li><a href="#TrixiAtmo.source_terms_lagrange_multiplier-Tuple{Any, Any, Any, Any, ShallowWaterEquations3D, Any}"><code>TrixiAtmo.source_terms_lagrange_multiplier</code></a></li><li><a href="#TrixiAtmo.transform_initial_condition-Tuple{Any, TrixiAtmo.AbstractCovariantEquations}"><code>TrixiAtmo.transform_initial_condition</code></a></li></ul><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TrixiAtmo.TrixiAtmo" href="#TrixiAtmo.TrixiAtmo"><code>TrixiAtmo.TrixiAtmo</code></a> ‚Äî <span class="docstring-category">Module</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">üåç TrixiAtmo üåç</code></pre><p><strong>TrixiAtmo.jl</strong> is a simulation package for atmospheric models based on <a href="https://github.com/trixi-framework/Trixi.jl">Trixi.jl</a></p><p>See also: <a href="https://github.com/trixi-framework/TrixiAtmo.jl">trixi-framework/TrixiAtmo.jl</a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiAtmo.jl/blob/{commit}{path}#{line}/blob/eb93cd2214fc37dc0fe0f4e00898edce417c90ee/src/TrixiAtmo.jl#L1-L8">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TrixiAtmo.AbstractCovariantEquations" href="#TrixiAtmo.AbstractCovariantEquations"><code>TrixiAtmo.AbstractCovariantEquations</code></a> ‚Äî <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">AbstractCovariantEquations{NDIMS, 
                           NDIMS_AMBIENT, 
                           GlobalCoordinateSystem,
                           NVARS} &lt;: AbstractEquations{NDIMS, NVARS}</code></pre><p>Abstract type used to dispatch on systems of equations in covariant form, in which fluxes and prognostic variables are stored and computed in terms of their contravariant components  defining their expansions in terms of the local covariant tangent basis. The type parameter <code>NDIMS</code> denotes the dimension of the manifold on which the equations are solved, while <code>NDIMS_AMBIENT</code> is the dimension of the ambient space in which such a manifold is embedded.  Some references on discontinuous Galerkin methods in covariant flux form are listed below:</p><ul><li>M. Baldauf (2020). Discontinuous Galerkin solver for the shallow-water equations in covariant form on the sphere and the ellipsoid. Journal of Computational Physics  410:109384. <a href="https://doi.org/10.1016/j.jcp.2020.109384">DOI: 10.1016/j.jcp.2020.109384</a> </li><li>M. Baldauf (2021). A horizontally explicit, vertically implicit (HEVI) discontinuous Galerkin scheme for the 2-dimensional Euler and Navier-Stokes equations using  terrain-following coordinates. Journal of Computational Physics 446:110635. <a href="https://doi.org/10.1016/j.jcp.2021.110635">DOI: 10.1016/ j.jcp.2021.110635</a></li><li>L. Bao, R. D. Nair, and H. M. Tufo (2014). A mass and momentum flux-form high-order discontinuous Galerkin shallow water model on the cubed-sphere. A mass and momentum  flux-form high-order discontinuous Galerkin shallow water model on the cubed-sphere.  Journal of Computational Physics 271:224-243.  <a href="https://doi.org/10.1016/j.jcp.2013.11.033">DOI: 10.1016/j.jcp.2013.11.033</a></li></ul><p>When using this equation type, functions which are evaluated pointwise, such as fluxes,  source terms, and initial conditions take in the extra argument <code>aux_vars</code>, which contains  the geometric information needed for the covariant form. The type parameter  <code>GlobalCoordinateSystem</code> specifies the global coordinate system used to define the  covariant tangent basis, and may be either <a href="#TrixiAtmo.GlobalCartesianCoordinates"><code>GlobalCartesianCoordinates</code></a> or  <a href="#TrixiAtmo.GlobalSphericalCoordinates"><code>GlobalSphericalCoordinates</code></a>. The <code>GlobalCoordinateSystem</code> type parameter also  specifies the coordinate system with respect to which the initial condition should be  prescribed.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiAtmo.jl/blob/{commit}{path}#{line}/blob/eb93cd2214fc37dc0fe0f4e00898edce417c90ee/src/equations/equations.jl#L6-L40">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TrixiAtmo.CovariantLinearAdvectionEquation2D" href="#TrixiAtmo.CovariantLinearAdvectionEquation2D"><code>TrixiAtmo.CovariantLinearAdvectionEquation2D</code></a> ‚Äî <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">CovariantLinearAdvectionEquation2D{GlobalCoordinateSystem} &lt;:  
    AbstractCovariantEquations{2, 3, GlobalCoordinateSystem, 3}</code></pre><p>A variable-coefficient linear advection equation can be defined on a two-dimensional manifold <span>$S \subset \mathbb{R}^3$</span> as</p><p class="math-container">\[\partial_t h + \nabla_S \cdot (h \vec{v}) = 0,\]</p><p>where <span>$\nabla_S \cdot$</span> is the horizontal divergence operator on <span>$S$</span>. We treat this problem  as a system of equations in which the first variable is the scalar conserved quantity <span>$h$</span>,  and the second two are the contravariant components <span>$v^1$</span> and <span>$v^2$</span> used in the expansion  with respect to the covariant basis vectors <span>$\vec{a}_1$</span> and <span>$\vec{a}_2$</span> as</p><p class="math-container">\[\vec{v} = v^1 \vec{a}_1 + v^2 \vec{a}_2,\]</p><p>where <span>$\vec{a}_1 = \partial \vec{x} / \partial \xi^1$</span> and  <span>$\vec{a}_2 = \partial \vec{x} / \partial \xi^2$</span> are the so-called covariant basis vectors,  and <span>$\xi^1$</span> and <span>$\xi^2$</span> are the local reference space coordinates. The velocity components  are spatially varying but assumed to be constant in time, so we do not apply any flux or  dissipation to such variables. The resulting system is then given on the reference element  as </p><p class="math-container">\[J \frac{\partial}{\partial t}
\left[\begin{array}{c} h \\ v^1 \\ v^2 \end{array}\right] 
+
\frac{\partial}{\partial \xi^1} 
\left[\begin{array}{c} J h v^1 \\ 0 \\ 0 \end{array}\right]
+ 
\frac{\partial}{\partial \xi^2} 
\left[\begin{array}{c} J h v^2 \\ 0 \\ 0 \end{array}\right] 
= 
\left[\begin{array}{c} 0 \\ 0 \\ 0 \end{array}\right],\]</p><p>where <span>$J = \lVert\vec{a}^1 \times \vec{a}^2 \rVert$</span> is the area element. Note that the  variable advection velocity components could alternatively be stored as auxiliary  variables, similarly to the geometric information.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiAtmo.jl/blob/{commit}{path}#{line}/blob/eb93cd2214fc37dc0fe0f4e00898edce417c90ee/src/equations/covariant_advection.jl#L4-L41">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TrixiAtmo.CovariantShallowWaterEquations2D" href="#TrixiAtmo.CovariantShallowWaterEquations2D"><code>TrixiAtmo.CovariantShallowWaterEquations2D</code></a> ‚Äî <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">CovariantShallowWaterEquations2D{GlobalCoordinateSystem} &lt;:  
    AbstractCovariantEquations{2, 3, GlobalCoordinateSystem, 3}</code></pre><p>Denoting the <a href="https://en.wikipedia.org/wiki/Covariant_derivative">covariant derivative</a> by  <span>$\nabla_b$</span> and summing over repeated indices, the shallow water equations can be expressed  on a two-dimensional surface in three-dimensional ambient space as</p><p class="math-container">\[\begin{aligned}
\partial_t h + \nabla_b (hv^b) &amp;= 0,\\
\partial_t (hv^a) + \nabla_b (hv^av^b) + gh G^{ab}\partial_b(h + b) 
&amp;= -fJ G^{ab}\varepsilon_{bc} hv^c,
\end{aligned}\]</p><p>where <span>$h$</span> is the fluid height, <span>$v^a$</span> and <span>$G^{ab}$</span> are the contravariant velocity and metric  tensor components, <span>$g$</span> is the gravitational constant, <span>$f$</span> is the Coriolis parameter,  <span>$J$</span> is the area element, and <span>$\partial_a$</span> is used as a shorthand for  <span>$\partial / \partial \xi^a$</span>. Combining the advective and pressure terms in order to define  the momentum flux components</p><p class="math-container">\[\tau^{ab} = hv^a v^b + \frac{1}{2}G^{ab}gh^2,\]</p><p>the covariant shallow water equations can be expressed as a system of conservation laws  with a source term (implemented in the exported function  <code>source_terms_geometric_coriolis</code>), as given by</p><p class="math-container">\[J \frac{\partial}{\partial t}
\left[\begin{array}{c} h \\ hv^1 \\ hv^2 \end{array}\right] 
+
\frac{\partial}{\partial \xi^1} 
\left[\begin{array}{c} J h v^1 \\ J \tau^{11} \\ J \tau^{12} \end{array}\right]
+ 
\frac{\partial}{\partial \xi^2} 
\left[\begin{array}{c} J h v^2 \\ J \tau^{21} \\ J \tau^{22}  \end{array}\right] 
= J \left[\begin{array}{c} 0 \\ 
-\Gamma^1_{ac}\tau^{ac} - f J \big(G^{12}hv^1 - G^{11}hv^2\big) \\ 
-\Gamma^2_{ac}\tau^{ac} - f J \big(G^{22}hv^1 - G^{21}hv^2\big)
 \end{array}\right].\]</p><p>Note that the geometric contribution to the source term involves the Christoffel symbols of the second kind, which can been expressed in terms of the covariant metric tensor components <span>$G_{ab}$</span> as </p><p class="math-container">\[\Gamma_{ac}^b = 
\frac{1}{2}G^{bd}\big(\partial_aG_{cd} + \partial_c G_{da} - \partial_d G_{ac}\big).\]</p><p><strong>References</strong></p><ul><li>M. Baldauf (2020). Discontinuous Galerkin solver for the shallow-water equations in covariant form on the sphere and the ellipsoid. Journal of Computational Physics  410:109384. <a href="https://doi.org/10.1016/j.jcp.2020.109384">DOI: 10.1016/j.jcp.2020.109384</a> </li><li>L. Bao, R. D. Nair, and H. M. Tufo (2014). A mass and momentum flux-form high-order discontinuous Galerkin shallow water model on the cubed-sphere. A mass and momentum  flux-form high-order discontinuous Galerkin shallow water model on the cubed-sphere.  Journal of Computational Physics 271:224-243.  <a href="https://doi.org/10.1016/j.jcp.2013.11.033">DOI: 10.1016/j.jcp.2013.11.033</a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiAtmo.jl/blob/{commit}{path}#{line}/blob/eb93cd2214fc37dc0fe0f4e00898edce417c90ee/src/equations/covariant_shallow_water.jl#L4-L57">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TrixiAtmo.GlobalCartesianCoordinates" href="#TrixiAtmo.GlobalCartesianCoordinates"><code>TrixiAtmo.GlobalCartesianCoordinates</code></a> ‚Äî <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">GlobalCartesianCoordinates()</code></pre><p>Struct used for dispatch, specifying that the covariant tangent basis vectors should be  defined with respect to a global Cartesian coordinate system.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiAtmo.jl/blob/{commit}{path}#{line}/blob/eb93cd2214fc37dc0fe0f4e00898edce417c90ee/src/equations/equations.jl#L46-L51">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TrixiAtmo.GlobalSphericalCoordinates" href="#TrixiAtmo.GlobalSphericalCoordinates"><code>TrixiAtmo.GlobalSphericalCoordinates</code></a> ‚Äî <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">GlobalSphericalCoordinates()</code></pre><p>Struct used for dispatch, specifying that the covariant tangent basis vectors should be  defined with respect to a global spherical coordinate system.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiAtmo.jl/blob/{commit}{path}#{line}/blob/eb93cd2214fc37dc0fe0f4e00898edce417c90ee/src/equations/equations.jl#L54-L59">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TrixiAtmo.MetricTermsCrossProduct" href="#TrixiAtmo.MetricTermsCrossProduct"><code>TrixiAtmo.MetricTermsCrossProduct</code></a> ‚Äî <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">MetricTermsCrossProduct()</code></pre><p>Struct used for multiple dispatch on functions that compute the metric terms. When the argument <code>metric_terms</code> is of type <code>MetricTermsCrossProduct</code>, the  contravariant vectors are computed using the cross-product form.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiAtmo.jl/blob/{commit}{path}#{line}/blob/eb93cd2214fc37dc0fe0f4e00898edce417c90ee/src/semidiscretization/semidiscretization.jl#L1-L7">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TrixiAtmo.MetricTermsInvariantCurl" href="#TrixiAtmo.MetricTermsInvariantCurl"><code>TrixiAtmo.MetricTermsInvariantCurl</code></a> ‚Äî <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">MetricTermsInvariantCurl()</code></pre><p>Struct used for multiple dispatch on functions that compute the metric terms. When the argument <code>metric_terms</code> is of type <code>MetricTermsInvariantCurl</code>, the  contravariant vectors are computed using the invariant curl form.</p><p><strong>References</strong></p><ul><li>Kopriva, D. A. (2006). Metric identities and the discontinuous spectral element method on  curvilinear meshes. Journal of Scientific Computing 26, 301-327.  <a href="https://doi.org/10.1007/s10915-005-9070-8">DOI: 10.1007/s10915-005-9070-8</a></li><li>Vinokur, M. and Yee, H. C. (2001). Extension of efficient low dissipation high order schemes for 3-D curvilinear moving grids. In Caughey, D. A., and Hafez, M. M. (eds.), Frontiers of Computational Fluid Dynamics 2002, World Scientific, Singapore, pp. 129‚Äì164. <a href="https://doi.org/10.1142/9789812810793_0008">DOI: 10.1142/9789812810793_0008</a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiAtmo.jl/blob/{commit}{path}#{line}/blob/eb93cd2214fc37dc0fe0f4e00898edce417c90ee/src/semidiscretization/semidiscretization.jl#L10-L24">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TrixiAtmo.ShallowWaterEquations3D" href="#TrixiAtmo.ShallowWaterEquations3D"><code>TrixiAtmo.ShallowWaterEquations3D</code></a> ‚Äî <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ShallowWaterEquations3D(; gravity, H0 = 0)</code></pre><p>Shallow water equations (SWE) in three space dimensions in conservation form (with constant bottom topography).  The equations are given by</p><p class="math-container">\[\begin{aligned}
  \frac{\partial h}{\partial t} + \frac{\partial}{\partial x}(h v_1)
    + \frac{\partial}{\partial y}(h v_2) + \frac{\partial}{\partial z}(h v_3) &amp;= 0 \\
    \frac{\partial}{\partial t}(h v_1) + \frac{\partial}{\partial x}\left(h v_1^2 + \frac{g}{2}h^2\right)
    + \frac{\partial}{\partial y}(h v_1 v_2) + \frac{\partial}{\partial z}(h v_1 v_3) &amp;= 0 \\
    \frac{\partial}{\partial t}(h v_2) + \frac{\partial}{\partial x}(h v_1 v_2)
    + \frac{\partial}{\partial y}\left(h v_2^2 + \frac{g}{2}h^2\right) + \frac{\partial}{\partial z}(h v_2 v_3) &amp;= 0 \\
    \frac{\partial}{\partial t}(h v_3) + \frac{\partial}{\partial x}(h v_1 v_3)
    + \frac{\partial}{\partial y}(h v_2 v_3) + \frac{\partial}{\partial z}\left(h v_3^2 + \frac{g}{2}h^2\right) &amp;= 0.
\end{aligned}\]</p><p>The unknown quantities of the SWE are the water height <span>$h$</span> and the velocities <span>$\mathbf{v} = (v_1, v_2, v_3)^T$</span>. The gravitational constant is denoted by <code>g</code>.</p><p>The 3D Shallow Water Equations (SWE) extend the 2D SWE to model shallow water flows on 2D manifolds embedded within 3D space.  To confine the flow to the 2D manifold, a source term incorporating a Lagrange multiplier is applied.  This term effectively removes momentum components that are normal to the manifold, ensuring the flow remains  constrained within the 2D surface.</p><p>The additional quantity <span>$H_0$</span> is also available to store a reference value for the total water height that is useful to set initial conditions or test the &quot;lake-at-rest&quot; well-balancedness.</p><p>In addition to the unknowns, Trixi.jl currently stores the bottom topography values at the approximation points despite being fixed in time. This is done for convenience of computing the bottom topography gradients on the fly during the approximation as well as computing auxiliary quantities like the total water height <span>$H$</span> or the entropy variables. This affects the implementation and use of these equations in various ways:</p><ul><li>The flux values corresponding to the bottom topography must be zero.</li><li>The bottom topography values must be included when defining initial conditions, boundary conditions or source terms.</li><li><a href="https://trixi-framework.github.io/Trixi.jl/stable/reference-trixi/#Trixi.AnalysisCallback"><code>AnalysisCallback</code></a> analyzes this variable.</li><li>Trixi.jl&#39;s visualization tools will visualize the bottom topography by default.</li></ul><p>References:</p><ul><li>J. Cot√© (1988). &quot;A Lagrange multiplier approach for the metric terms of semi-Lagrangian models on the sphere&quot;.  Quarterly Journal of the Royal Meteorological Society 114, 1347-1352. <a href="https://doi.org/10.1002/qj.49711448310">DOI: 10.1002/qj.49711448310</a></li><li>F. X. Giraldo (2001). &quot;A spectral element shallow water model on spherical geodesic grids&quot;.  <a href="https://doi.org/10.1002/1097-0363(20010430)35:8%3C869::AID-FLD116%3E3.0.CO;2-S">DOI: 10.1002/1097-0363(20010430)35:8&lt;869::AID-FLD116&gt;3.0.CO;2-S</a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiAtmo.jl/blob/{commit}{path}#{line}/blob/eb93cd2214fc37dc0fe0f4e00898edce417c90ee/src/equations/shallow_water_3d.jl#L4-L48">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TrixiAtmo.SplitCovariantShallowWaterEquations2D" href="#TrixiAtmo.SplitCovariantShallowWaterEquations2D"><code>TrixiAtmo.SplitCovariantShallowWaterEquations2D</code></a> ‚Äî <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">SplitCovariantShallowWaterEquations2D{GlobalCoordinateSystem} &lt;:  
    AbstractCovariantEquations{2, 3, GlobalCoordinateSystem, 3}</code></pre><p>Alternative flux formulation of <a href="#TrixiAtmo.CovariantShallowWaterEquations2D"><code>CovariantShallowWaterEquations2D</code></a> given on the  reference element by </p><p class="math-container">\[J \frac{\partial}{\partial t}
\left[\begin{array}{c} h \\ hv^1 \\ hv^2 \end{array}\right] 
+
\frac{\partial}{\partial \xi^1} 
\left[\begin{array}{c} J h v^1 \\ J h v^1 v^1 \\ J h v^2 v^1 \end{array}\right]
+ 
\frac{\partial}{\partial \xi^2} 
\left[\begin{array}{c} J h v^2 \\ J h v^1 v^2 \\ J h v^2 v^2 \end{array}\right] 
+
J \left[\begin{array}{c} 0 \\ \Upsilon^1 \\ \Upsilon^2 \end{array}\right] 
= 
J\left[\begin{array}{c}0 \\ s^1 \\ s^2 \end{array}\right].\]</p><p>In the above, the non-conservative differential terms in the momentum equations are given by</p><p class="math-container">\[\Upsilon^a = \frac{1}{2}hu^b\big(G^{ac}\partial_b u_c - \partial_b u^a\big) 
+ ghG^{ab}\partial_b h,\]</p><p>and the algebraic momentum source terms implemented in <code>source_terms_geometric_coriolis</code>  are given by</p><p class="math-container">\[s^a = \frac{1}{2}\big(\Gamma_{bc}^a hu^bu^c - G^{ac}\Gamma_{bc}^d hu^b u_d \big) 
- f JG^{ab}\varepsilon_{bc} hu^c,\]</p><p>where we use the same notation as in <a href="#TrixiAtmo.CovariantShallowWaterEquations2D"><code>CovariantShallowWaterEquations2D</code></a> (including  summation over repeated indices) and note that the covariant velocity components are given  by <span>$u_a = G_{ab} u^b$</span>. To obtain an entropy-conservative scheme with respect to the total  energy</p><p class="math-container">\[S = \frac{1}{2}h(u_1 u^1 + u_2u^2)  + \frac{1}{2}gh^2,\]</p><p>this equation type should be used with <code>volume_flux = (flux_ec, flux_nonconservative_ec)</code>.</p><div class="admonition is-warning"><header class="admonition-header">Experimental implementation</header><div class="admonition-body"><p>The use of entropy-stable split-form/flux-differencing formulations for covariant  equations is an experimental feature and may change in future releases.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiAtmo.jl/blob/{commit}{path}#{line}/blob/eb93cd2214fc37dc0fe0f4e00898edce417c90ee/src/equations/covariant_shallow_water_split.jl#L4-L46">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Trixi.flux_fjordholm_etal-Tuple{Any, Any, AbstractVector, ShallowWaterEquations3D}" href="#Trixi.flux_fjordholm_etal-Tuple{Any, Any, AbstractVector, ShallowWaterEquations3D}"><code>Trixi.flux_fjordholm_etal</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">flux_fjordholm_etal(u_ll, u_rr, orientation,
                    equations::ShallowWaterEquations1D)</code></pre><p>Total energy conservative (mathematical entropy for shallow water equations). When the bottom topography is nonzero this should only be used as a surface flux otherwise the scheme will not be well-balanced. For well-balancedness in the volume flux use <a href="#Trixi.flux_wintermeyer_etal-Tuple{Any, Any, AbstractVector, ShallowWaterEquations3D}"><code>flux_wintermeyer_etal</code></a>.</p><p>Details are available in Eq. (4.1) in the paper:</p><ul><li>Ulrik S. Fjordholm, Siddhartha Mishr and Eitan Tadmor (2011) Well-balanced and energy stable schemes for the shallow water equations with discontinuous topography <a href="https://doi.org/10.1016/j.jcp.2011.03.042">DOI: 10.1016/j.jcp.2011.03.042</a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiAtmo.jl/blob/{commit}{path}#{line}/blob/eb93cd2214fc37dc0fe0f4e00898edce417c90ee/src/equations/shallow_water_3d.jl#L162-L174">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Trixi.flux_wintermeyer_etal-Tuple{Any, Any, AbstractVector, ShallowWaterEquations3D}" href="#Trixi.flux_wintermeyer_etal-Tuple{Any, Any, AbstractVector, ShallowWaterEquations3D}"><code>Trixi.flux_wintermeyer_etal</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">flux_wintermeyer_etal(u_ll, u_rr, orientation_or_normal_direction,
                      equations::ShallowWaterEquations2D)</code></pre><p>Total energy conservative (mathematical entropy for shallow water equations) split form. When the bottom topography is nonzero this scheme will be well-balanced when used as a <code>volume_flux</code>. For the <code>surface_flux</code> either <a href="#Trixi.flux_wintermeyer_etal-Tuple{Any, Any, AbstractVector, ShallowWaterEquations3D}"><code>flux_wintermeyer_etal</code></a> or <a href="#Trixi.flux_fjordholm_etal-Tuple{Any, Any, AbstractVector, ShallowWaterEquations3D}"><code>flux_fjordholm_etal</code></a> can be used to ensure well-balancedness and entropy conservation.</p><p>Further details are available in Theorem 1 of the paper:</p><ul><li>Niklas Wintermeyer, Andrew R. Winters, Gregor J. Gassner and David A. Kopriva (2017) An entropy stable nodal discontinuous Galerkin method for the two dimensional shallow water equations on unstructured curvilinear meshes with discontinuous bathymetry <a href="https://doi.org/10.1016/j.jcp.2017.03.036">DOI: 10.1016/j.jcp.2017.03.036</a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiAtmo.jl/blob/{commit}{path}#{line}/blob/eb93cd2214fc37dc0fe0f4e00898edce417c90ee/src/equations/shallow_water_3d.jl#L117-L131">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TrixiAtmo.P4estMeshCubedSphere2D-Tuple{Any, Any}" href="#TrixiAtmo.P4estMeshCubedSphere2D-Tuple{Any, Any}"><code>TrixiAtmo.P4estMeshCubedSphere2D</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">P4estMeshCubedSphere2D(trees_per_face_dimension, radius;
                        polydeg, RealT=Float64,
                        initial_refinement_level=0, unsaved_changes=true,
                        p4est_partition_allow_for_coarsening=true,
                        element_local_mapping=false)</code></pre><p>Build a &quot;Cubed Sphere&quot; mesh as a 2D <code>P4estMesh</code> with <code>6 * trees_per_face_dimension^2</code> trees.</p><p>The mesh will have no boundaries.</p><p><strong>Arguments</strong></p><ul><li><code>trees_per_face_dimension::Integer</code>: the number of trees in the two local dimensions of                                      each face.</li><li><code>radius::Integer</code>: the radius of the sphere.</li><li><code>polydeg::Integer</code>: polynomial degree used to store the geometry of the mesh.                     The mapping will be approximated by an interpolation polynomial                     of the specified degree for each tree.</li><li><code>RealT::Type</code>: the type that should be used for coordinates.</li><li><code>initial_refinement_level::Integer</code>: refine the mesh uniformly to this level before the simulation starts.</li><li><code>unsaved_changes::Bool</code>: if set to <code>true</code>, the mesh will be saved to a mesh file.</li><li><code>p4est_partition_allow_for_coarsening::Bool</code>: Must be <code>true</code> when using AMR to make mesh adaptivity independent of domain partitioning. Should be <code>false</code> for static meshes to permit more fine-grained partitioning.</li><li><code>element_local_mapping::Bool</code>: option to use the alternative element-local mapping from Appendix A of <a href="https://doi.org/10.5194/gmd-7-2803-2014">Guba et al. (2014)</a>. If set to  <code>true</code>, the four corner vertex positions for each element will be obtained through an  equiangular gnomonic projection <a href="https://doi.org/10.1006/jcph.1996. 0047">(Ronchi et al. 1996)</a>, and the tree node coordinates within the element (i.e. the field  <code>tree_node_coordinates</code>) will be obtained by first using a bilinear mapping based on the  four corner vertices, and then projecting the bilinearly mapped nodes onto the spherical  surface by normalizing the resulting Cartesian coordinates and scaling by  <code>radius</code>. If  set to <code>false</code>, the equiangular gnomonic projection will be used for all tree node  coordinates.</li></ul><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>Adaptivity and MPI parallelization are not yet supported for equations in covariant  form, and we require <code>initial_refinement_level = 0</code> for such cases. Furthermore, the  calculation of the metric terms for the covariant form currently requires <code>polydeg</code> to  be equal to the polynomial degree of the solver, and <code>element_local_mapping = true</code>.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiAtmo.jl/blob/{commit}{path}#{line}/blob/eb93cd2214fc37dc0fe0f4e00898edce417c90ee/src/meshes/p4est_cubed_sphere.jl#L4-L46">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TrixiAtmo.P4estMeshQuadIcosahedron2D-Tuple{Any, Any}" href="#TrixiAtmo.P4estMeshQuadIcosahedron2D-Tuple{Any, Any}"><code>TrixiAtmo.P4estMeshQuadIcosahedron2D</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">P4estMeshQuadIcosahedron2D(trees_per_face_dimension, radius;
                           polydeg, RealT=Float64,
                           initial_refinement_level=0, unsaved_changes=true,
                           p4est_partition_allow_for_coarsening=true)</code></pre><p>Build a quad-based icosahedral mesh as a 2D <code>P4estMesh</code> with <code>60 * trees_per_face_dimension^2</code> trees (20 triangular faces of the icosahedron, each subdivided into 3 parent quads, each of which subdivided into <code>trees_per_face_dimension^2</code> trees).</p><p>The node coordinates of the trees will be obtained using the element-local mapping from Appendix A of <a href="https://doi.org/10.5194/gmd-7-2803-2014">Guba et al. (2014)</a>.  See <a href="#TrixiAtmo.P4estMeshCubedSphere2D-Tuple{Any, Any}"><code>P4estMeshCubedSphere2D</code></a> for more information about the element-local mapping.</p><p>The mesh will have no boundaries.</p><p><strong>Arguments</strong></p><ul><li><code>trees_per_face_dimension::Integer</code>: the number of trees in the two local dimensions of                                      each parent quad.</li><li><code>radius::Integer</code>: the radius of the sphere.</li><li><code>polydeg::Integer</code>: polynomial degree used to store the geometry of the mesh.                     The mapping will be approximated by an interpolation polynomial                     of the specified degree for each tree.</li><li><code>RealT::Type</code>: the type that should be used for coordinates.</li><li><code>initial_refinement_level::Integer</code>: refine the mesh uniformly to this level before the simulation starts.</li><li><code>unsaved_changes::Bool</code>: if set to <code>true</code>, the mesh will be saved to a mesh file.</li><li><code>p4est_partition_allow_for_coarsening::Bool</code>: Must be <code>true</code> when using AMR to make mesh adaptivity independent of domain partitioning. Should be <code>false</code> for static meshes to permit more fine-grained partitioning.</li></ul><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>Adaptivity and MPI parallelization are not yet supported for equations in covariant  form, and we require <code>initial_refinement_level = 0</code> for such cases. Furthermore, the  calculation of the metric terms for the covariant form currently requires <code>polydeg</code> to  be equal to the polynomial degree of the solver.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiAtmo.jl/blob/{commit}{path}#{line}/blob/eb93cd2214fc37dc0fe0f4e00898edce417c90ee/src/meshes/p4est_icosahedron_quads.jl#L5-L41">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TrixiAtmo.clean_solution_lagrange_multiplier!-Tuple{Any, ShallowWaterEquations3D, Any}" href="#TrixiAtmo.clean_solution_lagrange_multiplier!-Tuple{Any, ShallowWaterEquations3D, Any}"><code>TrixiAtmo.clean_solution_lagrange_multiplier!</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">     clean_solution_lagrange_multiplier!(u, equations::ShallowWaterEquations3D, normal_direction)</code></pre><p>Function to apply Lagrange multiplier discretely to the solution in order to constrain  the momentum to a 2D manifold.</p><p>The vector normal_direction is perpendicular to the 2D manifold. By default,  this is the normal contravariant basis vector.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiAtmo.jl/blob/{commit}{path}#{line}/blob/eb93cd2214fc37dc0fe0f4e00898edce417c90ee/src/equations/shallow_water_3d.jl#L232-L240">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TrixiAtmo.contravariant2global" href="#TrixiAtmo.contravariant2global"><code>TrixiAtmo.contravariant2global</code></a> ‚Äî <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">contravariant2global(u, aux_vars, equations)</code></pre><p>Transform the vector <code>u</code> of solution variables with the momentum or velocity given in terms  of local contravariant components into the global coordinate system specified by the  <code>GlobalCoordinateSystem</code> type parameter in <a href="#TrixiAtmo.AbstractCovariantEquations"><code>AbstractCovariantEquations</code></a>. <code>u</code> is a  vector type of the correct length <code>nvariables(equations)</code>. Notice the function doesn&#39;t  include any error checks for the purpose of efficiency, so please make sure your input is  correct. The inverse conversion is performed by <a href="#TrixiAtmo.global2contravariant"><code>global2contravariant</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiAtmo.jl/blob/{commit}{path}#{line}/blob/eb93cd2214fc37dc0fe0f4e00898edce417c90ee/src/equations/equations.jl#L110-L119">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TrixiAtmo.examples_dir-Tuple{}" href="#TrixiAtmo.examples_dir-Tuple{}"><code>TrixiAtmo.examples_dir</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">examples_dir()</code></pre><p>Return the directory where the example files provided with TrixiAtmo.jl are located. If TrixiAtmo.jl is installed as a regular package (with <code>]add Trixi</code>), these files are read-only and should <em>not</em> be modified. To find out which files are available, use, e.g., <code>readdir</code>:</p><p><strong>Examples</strong></p><pre><code class="language- hljs">readdir(examples_dir())</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiAtmo.jl/blob/{commit}{path}#{line}/blob/eb93cd2214fc37dc0fe0f4e00898edce417c90ee/src/auxiliary/auxiliary.jl#L1-L14">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TrixiAtmo.global2contravariant" href="#TrixiAtmo.global2contravariant"><code>TrixiAtmo.global2contravariant</code></a> ‚Äî <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">global2contravariant(u, aux_vars, equations)</code></pre><p>Transform the vector <code>u</code> of solution variables with momentum or velocity components given with respect to the global coordinate system into local contravariant components. The  global coordinate system is specified by the <code>GlobalCoordinateSystem</code> type parameter in  <a href="#TrixiAtmo.AbstractCovariantEquations"><code>AbstractCovariantEquations</code></a>. <code>u</code> is a vector type of the correct length  <code>nvariables(equations)</code>. Notice the function doesn&#39;t include any error checks for the  purpose of efficiency, so please make sure your input is correct. The inverse conversion is  performed by <a href="#TrixiAtmo.contravariant2global"><code>contravariant2global</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiAtmo.jl/blob/{commit}{path}#{line}/blob/eb93cd2214fc37dc0fe0f4e00898edce417c90ee/src/equations/equations.jl#L122-L132">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TrixiAtmo.have_aux_node_vars-Tuple{Trixi.AbstractEquations}" href="#TrixiAtmo.have_aux_node_vars-Tuple{Trixi.AbstractEquations}"><code>TrixiAtmo.have_aux_node_vars</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">have_aux_node_vars(equations)</code></pre><p>Trait function determining whether <code>equations</code> requires the use of auxiliary variables. Classical conservation laws such as the <a href="https://trixi-framework.github.io/Trixi.jl/stable/reference-trixi/#Trixi.CompressibleEulerEquations2D"><code>CompressibleEulerEquations2D</code></a> do not  require auxiliary variables. The return value will be <code>True()</code> or <code>False()</code> to allow  dispatching on the return type.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiAtmo.jl/blob/{commit}{path}#{line}/blob/eb93cd2214fc37dc0fe0f4e00898edce417c90ee/src/equations/equations.jl#L62-L69">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TrixiAtmo.initial_condition_gaussian-Tuple{Any, Any, Any}" href="#TrixiAtmo.initial_condition_gaussian-Tuple{Any, Any, Any}"><code>TrixiAtmo.initial_condition_gaussian</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">initial_condition_gaussian(x, t, equations)</code></pre><p>This Gaussian bell case is a smooth initial condition suitable for testing the convergence  of discretizations of the linear advection equation on a spherical domain of radius <span>$a = 6. 37122 \times 10^3\ \mathrm{m}$</span>, representing the surface of the Earth. Denoting the  Euclidean norm as <span>$\lVert \cdot \rVert$</span>, the initial height field is given by</p><p class="math-container">\[h(\vec{x}) = h_0 \exp
\Big(-b_0 \big(\lVert \vec{x} - \vec{x}_0 \rVert / \lVert \vec{x} \rVert\big)^2 \Big),\]</p><p>where <span>$h_0 = 1 \times 10^3\ \mathrm{m}$</span> is the height of the bell, <span>$b_0 = 5$</span> is the  width parameter, and <span>$\vec{x}_0$</span> is the position of the centre of the bell, which is  initialized at a longitude of <span>$3\pi/2$</span> and a latitude of zero. The velocity field  corresponds to a solid body rotation with a period of 12 days at an angle of  <span>$\alpha = \pi/4$</span> from the polar axis. Denoting <span>$\vec{\omega}$</span> as the corresponding angular velocity vector, the velocity is therefore initialized as</p><p class="math-container">\[\vec{v}(\vec{x}) = \vec{\omega} \times \vec{x}.\]</p><p>This problem is adapted from Case 1 of the test suite described in the following paper:</p><ul><li>D. L. Williamson, J. B. Drake, J. J. Hack, R. Jakob, and P. N. Swarztrauber (1992). A   standard test set for numerical approximations to the shallow water equations in spherical geometry. Journal of Computational Physics, 102(1):211-224.  <a href="https://doi.org/10.1016/S0021-9991(05)80016-6">DOI: 10.1016/S0021-9991(05)80016-6</a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiAtmo.jl/blob/{commit}{path}#{line}/blob/eb93cd2214fc37dc0fe0f4e00898edce417c90ee/src/equations/reference_data.jl#L10-L35">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TrixiAtmo.initial_condition_geostrophic_balance-Tuple{Any, Any, Any}" href="#TrixiAtmo.initial_condition_geostrophic_balance-Tuple{Any, Any, Any}"><code>TrixiAtmo.initial_condition_geostrophic_balance</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">initial_condition_geostrophic_balance(x, t, equations)</code></pre><p>Steady geostrophic balance for the spherical shallow water equations, corresponding to a  purely zonal velocity field given as a function of the latitude <span>$\theta$</span> by  <span>$v_\lambda(\theta) = v_0 \cos\theta$</span>, where we define <span>$v_0 = 2\pi a / (12 \ \mathrm{days})$</span>  in terms of the Earth&#39;s radius <span>$a = 6.37122 \times 10^3\ \mathrm{m}$</span>. The height field  then varies with the latitude as</p><p class="math-container">\[h(\theta) = \frac{1}{g} 
\Big(gh_0 - \Big(a \Omega v_0 + \frac{1}{2} v_0^2\Big)\sin^2\theta\Big),\]</p><p>where <span>$gh_0 = 2.94 \times 10^4 \ \mathrm{m}^2/\mathrm{s}^2$</span>,  <span>$g = 9.80616 \ \mathrm{m}/\mathrm{s}^2$</span>, and  <span>$\Omega = 7.292 \times 10^{-5}\ \mathrm{s}^{-1}$</span>. This problem corresponds to Case 2 of the test suite described in the following paper:</p><ul><li>D. L. Williamson, J. B. Drake, J. J. Hack, R. Jakob, and P. N. Swarztrauber (1992). A   standard test set for numerical approximations to the shallow water equations in spherical geometry. Journal of Computational Physics, 102(1):211-224.  <a href="https://doi.org/10.1016/S0021-9991(05)80016-6">DOI: 10.1016/S0021-9991(05)80016-6</a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiAtmo.jl/blob/{commit}{path}#{line}/blob/eb93cd2214fc37dc0fe0f4e00898edce417c90ee/src/equations/reference_data.jl#L70-L90">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TrixiAtmo.initial_condition_rossby_haurwitz-Tuple{Any, Any, Any}" href="#TrixiAtmo.initial_condition_rossby_haurwitz-Tuple{Any, Any, Any}"><code>TrixiAtmo.initial_condition_rossby_haurwitz</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">initial_condition_rossby_haurwitz(x, t, equations)</code></pre><p>Rossby-Haurwitz wave case for the spherical shallow water equations, where the zonal and  meridional velocity components are given, respectively, as functions of the longitude  <span>$\lambda$</span> and latitude <span>$\theta$</span> by</p><p class="math-container">\[\begin{aligned}
v_\lambda(\lambda,\theta) &amp;= a \omega \cos \theta+a K \cos ^{R-1} \theta
\left(R \sin ^2 \theta-\cos ^2 \theta\right) \cos (R \lambda),\\
v_\theta(\lambda,\theta) &amp;= -a K R \cos ^{R-1} \theta \sin \theta \sin (R \lambda),
\end{aligned}\]</p><p>where <span>$\omega = K = 7.848 \times 10^{-6} \ \mathrm{s}^{-1}$</span> and <span>$R = 4$</span> are given  constants, and <span>$a = 6.37122 \times 10^3\ \mathrm{m}$</span> is the Earth&#39;s radius. Taking  <span>$g = 9.80616 \ \mathrm{m}/\mathrm{s}^2$</span>, <span>$\Omega = 7.292 \times 10^{-5} \ \mathrm{s}^{-1}$</span>,  and <span>$h_0 = 8000 \ \mathrm{m}$</span> and defining the functions </p><p class="math-container">\[\begin{aligned}
A(\theta) &amp;=  \frac{\omega}{2}(2 \Omega+\omega) \cos^2 \theta + 
\frac{1}{4} K^2 \cos^{2 R} \theta\Big((R+1) \cos^2\theta +\left(2 R^2-R-2\right) - 
\big(2 R^2 / \cos^2 \theta\big) \Big), \\
B(\theta) &amp;= \frac{2(\Omega+\omega) K}{(R+1)(R+2)} \cos ^R \theta\big((R^2+2 R+2) - 
(R+1)^2 \cos^2 \theta\big), \\
C(\theta) &amp;=  \frac{1}{4} K^2 \cos^{2 R} \theta\big((R+1) \cos^2 \theta-(R+2)\big),
\end{aligned}\]</p><p>the initial height field is given by</p><p class="math-container">\[h(\lambda,\theta) = h_0 + 
\frac{a^2}{g}\Big(A(\theta) + B(\theta)\cos(R\lambda) + C(\theta)\cos(2R\lambda) \Big).\]</p><p>This problem corresponds to Case 6 of the test suite described in the following paper:</p><ul><li>D. L. Williamson, J. B. Drake, J. J. Hack, R. Jakob, and P. N. Swarztrauber (1992). A   standard test set for numerical approximations to the shallow water equations in spherical geometry. Journal of Computational Physics, 102(1):211-224.  <a href="https://doi.org/10.1016/S0021-9991(05)80016-6">DOI: 10.1016/S0021-9991(05)80016-6</a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiAtmo.jl/blob/{commit}{path}#{line}/blob/eb93cd2214fc37dc0fe0f4e00898edce417c90ee/src/equations/reference_data.jl#L109-L146">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TrixiAtmo.source_terms_lagrange_multiplier-Tuple{Any, Any, Any, Any, ShallowWaterEquations3D, Any}" href="#TrixiAtmo.source_terms_lagrange_multiplier-Tuple{Any, Any, Any, Any, ShallowWaterEquations3D, Any}"><code>TrixiAtmo.source_terms_lagrange_multiplier</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">source_terms_lagrange_multiplier(u, du, x, t,
                                      equations::ShallowWaterEquations3D,
                                      normal_direction)</code></pre><p>Source term function to apply a Lagrange multiplier to the semi-discretization in order to constrain the momentum to a 2D manifold.</p><p>The vector normal_direction is perpendicular to the 2D manifold. By default,  this is the normal contravariant basis vector.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiAtmo.jl/blob/{commit}{path}#{line}/blob/eb93cd2214fc37dc0fe0f4e00898edce417c90ee/src/equations/shallow_water_3d.jl#L206-L216">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TrixiAtmo.transform_initial_condition-Tuple{Any, TrixiAtmo.AbstractCovariantEquations}" href="#TrixiAtmo.transform_initial_condition-Tuple{Any, TrixiAtmo.AbstractCovariantEquations}"><code>TrixiAtmo.transform_initial_condition</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">transform_initial_condition(initial_condition, equations)</code></pre><p>Takes in a function with the signature <code>initial_condition(x, t, equations)</code> which returns  an initial condition given in terms of global Cartesian or zonal/meridional velocity components, and returns another function <code>initial_condition_transformed(x, t, equations)</code>  or <code>initial_condition_transformed(x, t, aux_vars, equations)</code> which returns the same  initial data, but transformed to the appropriate prognostic variables used internally by  the solver. For the covariant form, this involves a transformation of the global velocity  components to contravariant components using <a href="#TrixiAtmo.global2contravariant"><code>global2contravariant</code></a> as well as a  conversion from primitive to conservative variables. For standard Cartesian formulations,  this simply involves a conversion from  primitive to conservative variables. The intention  here is to have a set of test cases (for example, <a href="#TrixiAtmo.initial_condition_gaussian-Tuple{Any, Any, Any}"><code>initial_condition_gaussian</code></a>) for  which the initial condition is prescribed using a standardized set of primitive variables  in a global coordinate system, and transformed to the specific prognostic variables  required for a given model.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>When using the covariant formulation, the initial velocity components should be defined  in the coordinate system specified by the <code>GlobalCoordinateSystem</code> type parameter in <a href="#TrixiAtmo.AbstractCovariantEquations"><code>AbstractCovariantEquations</code></a>.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiAtmo.jl/blob/{commit}{path}#{line}/blob/eb93cd2214fc37dc0fe0f4e00898edce417c90ee/src/equations/equations.jl#L72-L92">source</a></section></article></article><nav class="docs-footer"><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.0 on <span class="colophon-date" title="Thursday 30 January 2025 02:27">Thursday 30 January 2025</span>. Using Julia version 1.11.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
